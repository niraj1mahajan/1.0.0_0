(()=>{function e(e,t){return`\n    <div class="vulnerability-item severity-${e.severity}">\n        <span>${t}) </span>\n        <span class="vulnerability-item-title">${e.title}</span>\n        <br>\n        <a href="${e.url}">${e.url}</a>\n        <span>${e.src}</span>\n\n    </div>`}function t(e){let t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}try{!function n(){let l=document.modeForm.mode,o=null;for(let e=0;e<l.length;e++)l[e].addEventListener("change",(function(){this!==o&&(o=this),chrome.storage.sync.set({js_vulnerability_detector__mode:this.value})}));let i="analyze";function r(e,t){let n,l,o;for(l=document.getElementsByClassName("tabcontent"),n=0;n<l.length;n++)l[n].style.display="none";for(o=document.getElementsByClassName("tablinks"),n=0;n<o.length;n++)o[n].className=o[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}chrome.storage.sync.get("js_vulnerability_detector__mode",(function(e){i=e.js_vulnerability_detector__mode,i||(i="analyze",l[1].checked=!0,chrome.storage.sync.set({js_vulnerability_detector__mode:"analyze"})),l.value=i})),document.getElementById("modeSelectionButton").addEventListener("click",(e=>{r(e,"Mode")})),document.getElementById("historySelectionButton").addEventListener("click",(e=>{r(e,"History")})),document.getElementById("historySelectionButton").click(),document.getElementById("clear").addEventListener("click",(e=>{chrome.storage.local.set({vulnerableScriptsCount:0},(function(){})),chrome.storage.local.set({vulnerabilitiesCount:0},(function(){})),chrome.storage.local.set({processedScriptsCount:0},(function(){})),chrome.storage.local.set({vulnerabilities:[]},(function(){})),n()})),chrome.storage.local.get("vulnerableScriptsCount",(function(e){e.vulnerableScriptsCount||(e.vulnerableScriptsCount=0),document.getElementById("vulnerableScriptsFound").innerText=e.vulnerableScriptsCount})),chrome.storage.local.get("vulnerabilitiesCount",(function(e){e.vulnerabilitiesCount||(e.vulnerabilitiesCount=0),document.getElementById("vulnerabilitiesCount").innerText=e.vulnerabilitiesCount})),chrome.storage.local.get("processedScriptsCount",(function(e){e.processedScriptsCount||(e.processedScriptsCount=0),document.getElementById("processedScriptsCount").innerText=e.processedScriptsCount}));let c=document.getElementById("vulnerabilitiesList");c.innerHTML=null,chrome.storage.local.get("vulnerabilities",(function(n){if(!n.vulnerabilities)return;console.log(n);let l=n.vulnerabilities;for(let n=0;n<l.length;n++){let o=t(e(l[n],n+1));c.appendChild(o)}}))}()}catch(e){console.log(e)}})();